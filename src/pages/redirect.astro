---
import Layout from '../layouts/Layout.astro';
import { ShoppingCart, Shield, Zap, CheckCircle2, ArrowRight } from 'lucide-react';
---

<Layout title="Weiterleitung... | SchauAlles.com">
  <div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-brand-900 to-slate-900 relative overflow-hidden">
    <!-- Animated Background elements -->
    <div class="absolute inset-0">
      <div class="absolute top-[-10%] right-[10%] w-[500px] h-[500px] bg-brand-500/20 rounded-full mix-blend-screen filter blur-3xl animate-blob"></div>
      <div class="absolute bottom-[-20%] left-[10%] w-[600px] h-[600px] bg-blue-500/20 rounded-full mix-blend-screen filter blur-3xl animate-blob animation-delay-2000"></div>
      <div class="absolute top-[40%] left-[50%] w-[400px] h-[400px] bg-purple-500/10 rounded-full mix-blend-screen filter blur-3xl animate-blob animation-delay-4000"></div>
    </div>

    <!-- Floating particles -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
      <div class="particle"></div>
    </div>

    <div class="relative z-10 max-w-2xl w-full mx-4">
      <div class="bg-white/95 backdrop-blur-xl rounded-3xl shadow-2xl p-8 md:p-12 text-center border border-white/20">
        
        <!-- Icon with pulse animation -->
        <div class="mb-8 relative inline-block">
          <div class="w-24 h-24 bg-gradient-to-br from-brand-500 to-brand-600 rounded-full flex items-center justify-center mx-auto shadow-lg shadow-brand-500/50 animate-pulse-slow">
            <ShoppingCart className="w-12 h-12 text-white" />
          </div>
          <!-- Circular progress -->
          <svg class="absolute inset-0 w-24 h-24 mx-auto -rotate-90" viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="45" fill="none" stroke="#E5E7EB" stroke-width="4"/>
            <circle id="progress-circle" cx="50" cy="50" r="45" fill="none" stroke="url(#progressGradient)" stroke-width="4" stroke-linecap="round" stroke-dasharray="283" stroke-dashoffset="283" class="transition-all duration-1000"/>
            <defs>
              <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#3B82F6"/>
                <stop offset="100%" stop-color="#2563EB"/>
              </linearGradient>
            </defs>
          </svg>
        </div>

        <h1 class="text-3xl md:text-4xl font-extrabold text-slate-900 mb-4 tracking-tight">
          Fast geschafft!
        </h1>
        
        <p class="text-slate-600 text-lg leading-relaxed mb-8 max-w-md mx-auto">
          Sie werden in <span id="countdown" class="inline-flex items-center justify-center w-10 h-10 bg-brand-100 text-brand-700 font-bold rounded-full text-xl mx-1">10</span> Sekunden zu unserem sicheren Bestellportal weitergeleitet.
        </p>

        <!-- Feature badges -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
          <div class="flex items-center gap-3 bg-green-50 rounded-xl p-4 border border-green-100">
            <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0">
              <Shield className="w-5 h-5 text-white" />
            </div>
            <div class="text-left">
              <p class="text-sm font-bold text-green-900">SSL-gesichert</p>
              <p class="text-xs text-green-600">256-Bit Verschlüsselung</p>
            </div>
          </div>

          <div class="flex items-center gap-3 bg-blue-50 rounded-xl p-4 border border-blue-100">
            <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
              <Zap className="w-5 h-5 text-white" />
            </div>
            <div class="text-left">
              <p class="text-sm font-bold text-blue-900">Sofort-Aktivierung</p>
              <p class="text-xs text-blue-600">In wenigen Minuten</p>
            </div>
          </div>

          <div class="flex items-center gap-3 bg-purple-50 rounded-xl p-4 border border-purple-100">
            <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
              <CheckCircle2 className="w-5 h-5 text-white" />
            </div>
            <div class="text-left">
              <p class="text-sm font-bold text-purple-900">Sichere Zahlung</p>
              <p class="text-xs text-purple-600">Alle Methoden</p>
            </div>
          </div>
        </div>

        <!-- Progress bar -->
        <div class="mb-8">
          <div class="w-full h-2 bg-slate-200 rounded-full overflow-hidden">
            <div id="progress-bar" class="h-full bg-gradient-to-r from-brand-500 to-blue-500 rounded-full transition-all duration-1000 ease-linear" style="width: 0%"></div>
          </div>
        </div>

        <!-- Manual link -->
        <div class="text-sm text-slate-500">
          Keine Lust zu warten?
          <a href="#" id="manual-link" class="inline-flex items-center gap-1 text-brand-600 hover:text-brand-700 font-bold ml-1 group">
            Jetzt fortfahren
            <ArrowRight className="w-4 h-4 transform group-hover:translate-x-1 transition-transform" />
          </a>
        </div>
      </div>

      <!-- Trust badges below -->
      <div class="mt-8 flex items-center justify-center gap-6 text-white/70 text-sm">
        <div class="flex items-center gap-2">
          <Shield className="w-4 h-4" />
          <span>Datenschutz garantiert</span>
        </div>
        <div class="flex items-center gap-2">
          <CheckCircle2 className="w-4 h-4" />
          <span>Geprüfte Sicherheit</span>
        </div>
      </div>
    </div>
  </div>
</Layout>

<script>
    // URL Mapping Configuration
    const mapping = {
        '1': 'https://login.6iptv.cc/store/premium-iptv',
        '2': 'https://login.6iptv.cc/store/2-iptv-verbindungen',
        '3': 'https://login.6iptv.cc/store/3-iptv-verbindungen',
        '5': 'https://login.6iptv.cc/store/5-iptv-verbindungen'
    };

    // Get connections param
    const params = new URLSearchParams(window.location.search);
    const connections = params.get('connections') || '1';
    
    // Determine target URL
    const targetUrl = mapping[connections] || mapping['1'];
    
    // Set manual link href
    const manualLink = document.getElementById('manual-link');
    if (manualLink) manualLink.href = targetUrl;

    // Timer logic
    let seconds = 10;
    const totalSeconds = 10;
    const countdownEl = document.getElementById('countdown');
    const progressBar = document.getElementById('progress-bar');
    const progressCircle = document.getElementById('progress-circle');
    const circumference = 2 * Math.PI * 45; // 2πr where r=45
    
    // Initialize progress circle
    if (progressCircle) {
        progressCircle.style.strokeDasharray = circumference;
        progressCircle.style.strokeDashoffset = circumference;
    }
    
    const timer = setInterval(() => {
        seconds--;
        if (countdownEl) countdownEl.textContent = seconds.toString();
        
        // Update progress bar
        const progress = ((totalSeconds - seconds) / totalSeconds) * 100;
        if (progressBar) progressBar.style.width = `${progress}%`;
        
        // Update circular progress
        if (progressCircle) {
            const offset = circumference - (progress / 100) * circumference;
            progressCircle.style.strokeDashoffset = offset;
        }
        
        if (seconds <= 0) {
            clearInterval(timer);
            window.location.href = targetUrl;
        }
    }, 1000);
</script>

<style>
  @keyframes blob {
    0% { transform: translate(0px, 0px) scale(1); }
    33% { transform: translate(30px, -50px) scale(1.1); }
    66% { transform: translate(-20px, 20px) scale(0.9); }
    100% { transform: translate(0px, 0px) scale(1); }
  }
  
  @keyframes float {
    0%, 100% { transform: translateY(0px) translateX(0px); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { transform: translateY(-100vh) translateX(50px); opacity: 0; }
  }
  
  @keyframes pulse-slow {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.05); opacity: 0.9; }
  }
  
  .animate-blob {
    animation: blob 7s infinite;
  }
  
  .animation-delay-2000 {
    animation-delay: 2s;
  }
  
  .animation-delay-4000 {
    animation-delay: 4s;
  }
  
  .animate-pulse-slow {
    animation: pulse-slow 2s ease-in-out infinite;
  }
  
  .particle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: white;
    border-radius: 50%;
    animation: float linear infinite;
  }
  
  .particle:nth-child(1) {
    left: 10%;
    animation-duration: 8s;
    animation-delay: 0s;
  }
  
  .particle:nth-child(2) {
    left: 30%;
    animation-duration: 12s;
    animation-delay: 2s;
  }
  
  .particle:nth-child(3) {
    left: 50%;
    animation-duration: 10s;
    animation-delay: 4s;
  }
  
  .particle:nth-child(4) {
    left: 70%;
    animation-duration: 14s;
    animation-delay: 1s;
  }
  
  .particle:nth-child(5) {
    left: 90%;
    animation-duration: 11s;
    animation-delay: 3s;
  }
</style>
